local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Universal Hub | Lommbatois - Rafax_Alone e Drzinnss",
   LoadingTitle = "Limpando Funções...",
   LoadingSubtitle = "Criado por Gemini O Melhor",
   ConfigurationSaving = { Enabled = false },
   CustomImage = "128375058850166",
   Theme = "Darker" 
})

-- Variáveis de Controle
local _G = {
    AimbotEnabled = false,
    EspEnabled = false,
    BunnyHop = false,
    SelectedPlayer = "Todos",
    Sensitivity = 0.12
}

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")

--- === SISTEMA DE TIMES E ESP === ---
local function UpdateESP(player)
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local isEnemy = (player.Team ~= LocalPlayer.Team)
        local color = isEnemy and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(0, 0, 255)
        
        local highlight = player.Character:FindFirstChild("TeamHighlight") or Instance.new("Highlight", player.Character)
        highlight.Name = "TeamHighlight"
        highlight.FillColor = color
        highlight.Enabled = _G.EspEnabled and (_G.SelectedPlayer == "Todos" or _G.SelectedPlayer == player.Name)
        
        local bill = player.Character:FindFirstChild("DistGui") or Instance.new("BillboardGui", player.Character)
        bill.Name = "DistGui"
        bill.AlwaysOnTop = true
        bill.Size = UDim2.new(0, 100, 0, 40)
        bill.Adornee = player.Character:FindFirstChild("Head")
        bill.ExtentsOffset = Vector3.new(0, 3, 0)
        
        local lbl = bill:FindFirstChild("Label") or Instance.new("TextLabel", bill)
        lbl.Name = "Label"
        lbl.BackgroundTransparency = 1
        lbl.Size = UDim2.new(1, 0, 1, 0)
        lbl.TextColor3 = color
        lbl.TextSize = 14
        lbl.Font = Enum.Font.SourceSansBold
        
        local dist = math.floor((LocalPlayer.Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude)
        lbl.Text = player.Name .. " [" .. dist .. "m]"
        bill.Enabled = highlight.Enabled
    end
end

--- === LOOP PRINCIPAL === ---
RunService.Heartbeat:Connect(function()
    -- BUNNY HOP
    if _G.BunnyHop and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        if LocalPlayer.Character.Humanoid.FloorMaterial ~= Enum.Material.Air then
            LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end

    -- AIMBOT LOGIC
    if _G.AimbotEnabled then
        local Target = nil
        local MaxDist = 300
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= LocalPlayer and p.Character and p.Character:FindFirstChild("Head") then
                UpdateESP(p) -- Atualiza o ESP simultaneamente
                local isTarget = (_G.SelectedPlayer == "Todos" or p.Name == _G.SelectedPlayer)
                if isTarget then
                    local pos, onScreen = Camera:WorldToViewportPoint(p.Character.Head.Position)
                    if onScreen then
                        local mag = (Vector2.new(pos.X, pos.Y) - game:GetService("UserInputService"):GetMouseLocation()).Magnitude
                        if mag < MaxDist then Target = p MaxDist = mag end
                    end
                end
            end
        end

        if Target then
            Camera.CFrame = Camera.CFrame:Lerp(CFrame.new(Camera.CFrame.Position, Target.Character.Head.Position), _G.Sensitivity)
        end
    end
end)

--- === INTERFACE === ---
local MainTab = Window:CreateTab("Combate", 4483362458)
local VisualTab = Window:CreateTab("Visuais", 4483362458)
local MiscTab = Window:CreateTab("Outros", 4483362458)

MainTab:CreateToggle({
   Name = "Ativar Aimbot",
   CurrentValue = false,
   Callback = function(v) _G.AimbotEnabled = v end,
})

VisualTab:CreateToggle({
   Name = "ESP Global por Time",
   CurrentValue = false,
   Callback = function(v) _G.EspEnabled = v end,
})

MiscTab:CreateToggle({
   Name = "Bunny Hop",
   CurrentValue = false,
   Callback = function(v) _G.BunnyHop = v end,
})

MiscTab:CreateSection("Créditos: Lommbatois - Rafax_Alone e Drzinnss")

Rayfield:Notify({
   Title = "Script Atualizado",
   Content = "Burla e Auto-Shoot removidos. Criado por Gemini O Melhor.",
   Duration = 5
})
